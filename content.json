{"posts":[{"title":"Hexo + Github Actions部署在线博客","text":"前言需求为使用github pages搭建一个在线的静态网站，方便记录日志和文档，经过选型，决定采用hexo方案。 hexo采用node.js编译，能自动将md文件编译为静态网页，因此最终采用的方案为： 使用hexo框架将md编译成静态网址，然后部署到github pages中，为了减少手动部署的繁琐，决定使用github action功能自动部署 github需要新建两个仓库： online-blog-source （用于存放源码） brettzhang.github.io （github page，由于显示静态网页） 准备工作github 准备本方案中，需要将source中的代码经过github action自动编译部署到github pages中，因此需要先授权： 本地电脑上运行以下命令生成密钥： 1ssh-keygen -f github-deploy-key 当前目录下会有 github-deploy-key 和 github-deploy-key.pub 两个文件。 source仓库配置进入对应仓库Settings -&gt; Secrets and variables -&gt; Actions -&gt; New repository secret中添加 name填写 HEXO_DEPLOY_PRI Secret中添加本地文件github-deploy-key中的值（通过文本工具打开复制即可） github page仓库配置进入对应仓库Settings -&gt; Deploy keys -&gt; Add deploy key中添加 Title配置为HEXO_DEPLOY_PUB Key配置为本地文件github-deploy-key.pub中的内容（通过文本工具打开分支即可） 勾选Allow write access 一定要勾选，否则github action部署时，会提示无权限 本地电脑环境安装本人采用pnpm管理node.js项目，因此需要先安装pnpm，并配置全局仓库，在~/.zshrc中添加内容 1234567# pnpmexport PNPM_HOME=&quot;/home/work/tool/pnpm&quot;case &quot;:$PATH:&quot; in *&quot;:$PNPM_HOME:&quot;*) ;; *) export PATH=&quot;$PNPM_HOME:$PATH&quot; ;;esac# pnpm end Hexo 初始化本地新建一个与source同名仓库文件夹（不同名也可以），然后终端进入对应目录中 1cd online-blog-source 安装hexo工具： 1pnpm add hexo-cli -g 然后初始化博客框架： 1hexo init . 安装主题hexo-theme-icarus,并将hexo配置为对应主题： 1234pnpm add hexo-theme-icarus hexo-renderer-inferno babel-plugin-inferno @babel/preset-env # 也可手动修改_config.ymlhexo config theme icarus 安装hexo git插件，用于编译完成之后，自动推送到github page仓库，如果不装此插件，部署时会提示找不到git 1hexo-deployer-git 然后可以本地开启预览： 1hexo server 此时如果终端没有提示报错的话，那么可以通过http://localhost:4000/预览。 上传与部署上传源码将本地文件夹初始化为git仓库，并上传到source 仓库 12345678910# 注意分支 我这里默认创建的是main分支git init .# 添加远端仓库git remote add origin git@github.com:brettzhang/online-blog-source.git# 提交git add .git commit -m 'init'git push -u origin main 配置github action添加本地仓库新建 .github/workflows/deploy.yml文件,并添加以下内容： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566name: Deploy hexo blogon: workflow_dispatch: inputs: name: description: 'Person to greet' required: true default: 'World' push: branches: - main # default branchjobs: build: runs-on: ubuntu-latest strategy: matrix: node-version: [20.x] steps: - uses: actions/checkout@v4 with: token: ${{ secrets.GITHUB_TOKEN }} # If your repository depends on submodule, please see: https://github.com/actions/checkout submodules: recursive # install pnpm to instead of npm - uses: pnpm/action-setup@v4 name: Install pnpm with: version: 10 run_install: false - name: Use Node.js ${{ matrix.node-version }} uses: actions/setup-node@v4 with: # Examples: 20, 18.19, &gt;=16.20.2, lts/Iron, lts/Hydrogen, *, latest, current, node # Ref: https://github.com/actions/setup-node#supported-version-syntax node-version: ${{ matrix.node-version }} cache: 'pnpm' - name: Configuration environment env: HEXO_DEPLOY_PRI: ${{secrets.HEXO_DEPLOY_PRI}} run: | sudo timedatectl set-timezone &quot;Asia/Shanghai&quot; mkdir -p ~/.ssh/ echo &quot;$HEXO_DEPLOY_PRI&quot; | tr -d '\\r' &gt; ~/.ssh/id_ed25519 chmod 600 ~/.ssh/id_ed25519 eval `ssh-agent` ssh-add ~/.ssh/id_ed25519 ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts git config --global user.name &quot;brettzhang&quot; git config --global user.email &quot;brttzhang@outlook.com&quot; - name: Install Dependencies run: | pnpm add hexo-cli -g pnpm install - name: Deploy hexo run: | hexo clean hexo d -g 然后上传到服务器： 123git add .git commit -m 'add action yaml'git push origin main","link":"/2025/04/18/Hexo-Github-Actions%E9%83%A8%E7%BD%B2%E5%9C%A8%E7%BA%BF%E5%8D%9A%E5%AE%A2/"},{"title":"My New Post","text":"","link":"/2025/04/18/My-New-Post/"},{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","link":"/2025/04/19/hello-world/"}],"tags":[{"name":"hexo github-action","slug":"hexo-github-action","link":"/tags/hexo-github-action/"}],"categories":[],"pages":[]}